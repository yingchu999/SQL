with a as (
select *, dense_rank() over (partition by departmentid order by salary desc) as r
from employee)

select d.name as department, a.name as employee, a.salary
from a join department d
on a.departmentid = d.id
where r <= 3;
