with a as
(select weekday(o.order_date) as weekday, i.item_category, sum(o.quantity) as total
from items i
left join orders o
on o.item_id = i.item_id
group by i.item_category, weekday)

select a.item_category as category,
sum(case when a.weekday = 0 then a.total else 0 end) as 'Monday',
sum(case when a.weekday = 1 then a.total else 0 end) as 'Tuesday',
sum(case when a.weekday = 2 then a.total else 0 end) as 'Wednesday',
sum(case when a.weekday = 3 then a.total else 0 end) as 'Thursday',
sum(case when a.weekday = 4 then a.total else 0 end) as 'Friday',
sum(case when a.weekday = 5 then a.total else 0 end) as 'Saturday',
sum(case when a.weekday = 6 then a.total else 0 end) as 'Sunday'
from a
group by a.item_category
order by a.item_category;
